# Firebase CLIë¥¼ í™œìš©í•œ Firestore ë°ì´í„°ë² ì´ìŠ¤ ë° ìƒ‰ì¸(Index) ë°°í¬ ê°€ì´ë“œ

Firebase ì½˜ì†”ì— ë§¤ë²ˆ ì ‘ì†í•˜ì§€ ì•Šê³ ë„, ë¡œì»¬ í„°ë¯¸ë„ì—ì„œ Firebase CLIë¥¼ í†µí•´ í•„ìš”í•œ ë³µí•© ìƒ‰ì¸(ì¼ë°˜ ëª¨ë“œ, ì±Œë¦°ì§€ ëª¨ë“œ)ì„ í•œ ë²ˆì— ë°°í¬í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
ì´ ë¬¸ì„œëŠ” ì‚¬ì²œì„± ê²Œìž„ì˜ ëª¨ë“  ë‚œì´ë„(ì¼ë°˜/ì±Œë¦°ì§€) ë¦¬ë”ë³´ë“œë¥¼ ìœ„í•´ í•„ìš”í•œ Firestore ìƒ‰ì¸ì„ ì •ì˜í•˜ê³  í„°ë¯¸ë„ì—ì„œ ë°°í¬í•˜ëŠ” ë°©ë²•ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.

## 1. Firebase CLI ì„¤ì¹˜ ë° ë¡œê·¸ì¸ (ì‚¬ì „ ì¤€ë¹„)
ì•„ì§ Firebase CLIê°€ ì„¤ì¹˜ë˜ì–´ ìžˆì§€ ì•Šë‹¤ë©´ ì•„ëž˜ ëª…ë ¹ì–´ë¥¼ í†µí•´ ì„¤ì¹˜í•˜ê³  ë¡œê·¸ì¸í•©ë‹ˆë‹¤.

```bash
# Firebase CLI ì „ì—­ ì„¤ì¹˜ (Node.js/npm í•„ìš”)
npm install -g firebase-tools

# Firebase ê³„ì • ë¡œê·¸ì¸ (ë¸Œë¼ìš°ì € ì°½ì´ ì—´ë¦¼)
firebase login
```

## 2. Firestore ìƒ‰ì¸(Index) ì„¤ì • íŒŒì¼ ìƒì„±

í”„ë¡œì íŠ¸ ë£¨íŠ¸ í´ë”(`c:\Project\android\sacheonseong_game`)ì— `firestore.indexes.json` ì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ íŒŒì¼ì„ ë§Œë“¤ê±°ë‚˜ ì—´ì–´ì„œ ì•„ëž˜ ë‚´ìš©ì„ ì €ìž¥í•©ë‹ˆë‹¤.
*(ì°¸ê³ : ì´ë²ˆ ê²Œìž„ í™˜ê²½ì—ì„œëŠ” **ì±Œë¦°ì§€ ëª¨ë“œ(ì ìˆ˜ ê¸°ì¤€)**ì™€ **ì¼ë°˜ ëª¨ë“œ(ì‹œê°„ ê¸°ì¤€)** ë‘ ê°€ì§€ì˜ ì™„ë²½í•œ ëž­í‚¹ ì •ë ¬ì„ ìœ„í•´ 2ê°œì˜ ë³µí•© ìƒ‰ì¸ì´ ëª¨ë‘ í•„ìš”í•©ë‹ˆë‹¤.)*

### `firestore.indexes.json` ì „ì²´ ë‚´ìš©
```json
{
  "indexes": [
    {
      "collectionGroup": "scores",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "difficulty",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "score",
          "order": "DESCENDING"
        },
        {
          "fieldPath": "createdAt",
          "order": "ASCENDING"
        }
      ]
    },
    {
      "collectionGroup": "scores",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "difficulty",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "seconds",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "createdAt",
          "order": "ASCENDING"
        }
      ]
    }
  ],
  "fieldOverrides": []
}
```

* **ì²« ë²ˆì§¸ ì¸ë±ìŠ¤**: `(difficulty, score ë‚´ë¦¼ì°¨ìˆœ, createdAt)` âž” ì ìˆ˜ê°€ ë†’ì€ ìˆœì„œëŒ€ë¡œ ê¸°ë¡ë˜ëŠ” **ì±Œë¦°ì§€ ëª¨ë“œ(Challenge)** ì „ìš© ìƒ‰ì¸ìž…ë‹ˆë‹¤.
* **ë‘ ë²ˆì§¸ ì¸ë±ìŠ¤**: `(difficulty, seconds ì˜¤ë¦„ì°¨ìˆœ, createdAt)` âž” ëª©í‘œë¥¼ ë¹¨ë¦¬ í´ë¦¬ì–´í•œ ìˆœì„œëŒ€ë¡œ ê¸°ë¡ë˜ëŠ” **ì¼ë°˜ ëª¨ë“œ(Easy, Normal, Hard)** ì „ìš© ìƒ‰ì¸ìž…ë‹ˆë‹¤.

## 3. Firebase í”„ë¡œì íŠ¸ ì´ˆê¸°í™” (ì„ íƒ ì‚¬í•­)
í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ê°€ ì•„ì§ Firebase í”„ë¡œì íŠ¸ë¡œ ì—°ê²°ë˜ì–´ ìžˆì§€ ì•Šë‹¤ë©´ ì´ˆê¸°í™” ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤. (ì´ë¯¸ ì„¤ì •ì´ ë˜ì–´ìžˆë‹¤ë©´ ì´ ê³¼ì •ì€ ìƒëžµ ê°€ëŠ¥í•©ë‹ˆë‹¤.)

```bash
# Firestoreë¥¼ CLIì—ì„œ ë‹¤ë£° ìˆ˜ ìžˆë„ë¡ ì´ˆê¸°í™”
firebase init firestore

# í”„ë¡¬í”„íŠ¸ê°€ ë‚˜ì˜¤ë©´ í˜„ìž¬ í”„ë¡œì íŠ¸(sacheonseong)ë¥¼ ì„ íƒí•˜ê³ ,
# 'What file should be used for Firestore indexes?' ì§ˆë¬¸ì— 'firestore.indexes.json'ì„ ìž…ë ¥í•˜ë©´ ë©ë‹ˆë‹¤.
```

## 4. í„°ë¯¸ë„ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ (ìƒ‰ì¸ ì „ì²´ ë°°í¬)
ì´ì œ ì •ì˜í•œ ì–‘ë°©í–¥ ìƒ‰ì¸ì„ Firebase ì„œë²„ë¡œ ì¼ê´„ ë°°í¬í•©ë‹ˆë‹¤.
ì•„ëž˜ ëª…ë ¹ì–´ 1ì¤„ì´ë©´ í”„ë¡œì íŠ¸ì˜ Firestoreì— ì¼ë°˜ ëª¨ë“œì™€ ì±Œë¦°ì§€ ëª¨ë“œì˜ ë³µí•© ìƒ‰ì¸ 2ê°œê°€ ë™ì‹œì— ìƒì„±ë©ë‹ˆë‹¤.

```bash
# ì¼ë°˜ ëª¨ë“œì™€ ì±Œë¦°ì§€ ëª¨ë“œì˜ ìƒ‰ì¸ ë™ì‹œ ë°°í¬ ì‹¤í–‰
firebase deploy --only firestore:indexes
```

ë°°í¬ ì™„ë£Œ ë©”ì‹œì§€(`Deploy complete!`)ê°€ ë‚˜ì˜¤ë©´ ì¦‰ì‹œ ë°˜ì˜ì´ ì‹œìž‘ë˜ë©°, Firebaseê°€ ì„œë²„ ë‹¨ì—ì„œ ìƒ‰ì¸ êµ¬ì¶• ìž‘ì—…ì„ ì§„í–‰í•©ë‹ˆë‹¤. (êµ¬ì¶•ì—ëŠ” ë°ì´í„°ëŸ‰ì— ë”°ë¼ ì•½ 1~2ë¶„ì´ ì†Œìš”ë˜ë©°, ì™„ë£Œ í›„ ì•±ì—ì„œ ë‘ ëª¨ë“œ ëª¨ë‘ì˜ ë¦¬ë”ë³´ë“œê°€ ì—ëŸ¬ ì—†ì´ ì¦‰ì‹œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.)

---
**ðŸ’¡ íŒ:** ë§Œì•½ ë‚˜ì¤‘ì— ì›¹ ì½˜ì†” ë“±ì—ì„œ ìˆ˜ë™ìœ¼ë¡œ ë‹¤ë¥¸ ìƒ‰ì¸ì„ ë˜ ì¶”ê°€í•œ ê²½ìš°, ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ìž…ë ¥í•˜ë©´ ì›¹ì— ìžˆëŠ” ì „ì²´ ìƒ‰ì¸ ëª©ë¡ì„ ê°€ì ¸ì™€ì„œ ë¡œì»¬ì˜ `firestore.indexes.json` íŒŒì¼ì— ì•Œì•„ì„œ ë™ê¸°í™”(ë°±ì—…)í•´ì¤ë‹ˆë‹¤.
```bash
firebase firestore:indexes > firestore.indexes.json
```
