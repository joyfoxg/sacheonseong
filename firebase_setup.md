# Firebase CLI ì„¤ì¹˜ ë° Firestore ìƒ‰ì¸(Index) ë°°í¬ ì™„ë²½ ê°€ì´ë“œ

ì´ ë¬¸ì„œëŠ” í„°ë¯¸ë„(ëª…ë ¹ í”„ë¡¬í”„íŠ¸/PowerShell)ì„ ì´ìš©í•´ Firebase í”„ë¡œì íŠ¸ì— ë¡œê·¸ì¸í•˜ê³ , ì‚¬ì²œì„± ê²Œìž„ì˜ ëª¨ë“  ë‚œì´ë„(ì¼ë°˜/ì±Œë¦°ì§€) ë¦¬ë”ë³´ë“œë¥¼ ìœ„í•´ í•„ìš”í•œ Firestore ìƒ‰ì¸ì„ í•œ ë²ˆì— ë°°í¬í•˜ëŠ” ì „ì²´ ê³¼ì •ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.

---

## 1ë‹¨ê³„: Node.js ìœ ë¬´ í™•ì¸ ë° ì„¤ì¹˜ (ì‚¬ì „ ì¤€ë¹„)
Firebase CLIëŠ” Node.js í™˜ê²½ì—ì„œ ìž‘ë™í•©ë‹ˆë‹¤.
1. í„°ë¯¸ë„ì„ ì—´ê³  `npm -v`ë¥¼ ìž…ë ¥í•´ ìˆ«ìžê°€ ë‚˜ì˜¤ë©´ ì„¤ì¹˜ëœ ê²ƒìž…ë‹ˆë‹¤. (ë°”ë¡œ 2ë‹¨ê³„ë¡œ ë„˜ì–´ê°€ì„¸ìš”.)
2. ì˜¤ë¥˜ê°€ ë‚˜ê±°ë‚˜ ì„¤ì¹˜ë˜ì–´ ìžˆì§€ ì•Šë‹¤ë©´, [Node.js ê³µì‹ í™ˆíŽ˜ì´ì§€(https://nodejs.org)](https://nodejs.org/ko/)ì— ì ‘ì†í•˜ì—¬ **LTS ë²„ì „**ì„ ë‹¤ìš´ë¡œë“œí•˜ê³  ì„¤ì¹˜í•´ì£¼ì„¸ìš”.

## 2ë‹¨ê³„: Firebase CLI ì„¤ì¹˜
Node.js ì„¤ì¹˜ê°€ ì™„ë£Œë˜ì—ˆë‹¤ë©´, í„°ë¯¸ë„(í˜¹ì€ VS Code í„°ë¯¸ë„)ì„ ì—´ê³  ì•„ëž˜ ëª…ë ¹ì–´ë¥¼ ìž…ë ¥í•˜ì—¬ Firebase CLIë¥¼ ì»´í“¨í„°ì— ì „ì—­ ì„¤ì¹˜í•©ë‹ˆë‹¤.

```bash
npm install -g firebase-tools
```
*(Mac ì‚¬ìš©ìžì˜ ê²½ìš° ê¶Œí•œ ì—ëŸ¬ì‹œ `sudo npm install -g firebase-tools`ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.)*

## 3ë‹¨ê³„: Firebase ê³„ì • ë¡œê·¸ì¸
Firebaseì˜ ì„œë²„ ê¶Œí•œì„ ë¡œì»¬ í„°ë¯¸ë„ë¡œ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ êµ¬ê¸€ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.
í„°ë¯¸ë„ì— ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ìž…ë ¥í•©ë‹ˆë‹¤.

```bash
firebase login
```
* ëª…ë ¹ì–´ë¥¼ ì¹˜ë©´ **ì›¹ ë¸Œë¼ìš°ì € ì°½ì´ ìžë™ìœ¼ë¡œ ì—´ë¦½ë‹ˆë‹¤.**
* Firebase í”„ë¡œì íŠ¸(sacheonseong) ìƒì„±ì— ì‚¬ìš©í–ˆë˜ êµ¬ê¸€ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ê³  "í—ˆìš©(Allow)" ë²„íŠ¼ì„ ëˆ„ë¦…ë‹ˆë‹¤.
* í„°ë¯¸ë„ì— `Success! Logged in as [ì´ë©”ì¼]` ë©”ì‹œì§€ê°€ ëœ¨ë©´ ë¡œê·¸ì¸ ì„±ê³µìž…ë‹ˆë‹¤.

---

## 4ë‹¨ê³„: Firestore ìƒ‰ì¸(Index) ì„¤ì • íŒŒì¼ ìƒì„±

ë¡œê·¸ì¸ì´ ëë‚¬ë‹¤ë©´ í”„ë¡œì íŠ¸ ìµœìƒë‹¨ í´ë”(`c:\Project\android\sacheonseong_game`)ì— **`firestore.indexes.json`** ì´ë¼ëŠ” ì´ë¦„ì˜ íŒŒì¼ì„ ìƒˆë¡œ ë§Œë“¤ê³  ì•„ëž˜ì˜ ë‚´ìš©ì„ ê·¸ëŒ€ë¡œ ë³µì‚¬í•´ ì €ìž¥í•©ë‹ˆë‹¤.

> **ì°¸ê³ :** ì•„ëž˜ ì½”ë“œëŠ” (1) **ì¼ë°˜ ëª¨ë“œ**(ì‹œê°„ ë¹ ë¦„ ê¸°ì¤€)ì™€ (2) **ì±Œë¦°ì§€ ëª¨ë“œ**(ì ìˆ˜ ë†’ìŒ ê¸°ì¤€) ë‘ ê°€ì§€ì˜ ì™„ë²½í•œ ëž­í‚¹ ì •ë ¬ì„ ìœ„í•´ 2ê°œì˜ ë³µí•© ìƒ‰ì¸ì„ í•œ ë²ˆì— êµ¬ì„±í•˜ëŠ” ì½”ë“œìž…ë‹ˆë‹¤.

### `firestore.indexes.json` ì „ì²´ ë‚´ìš©
```json
{
  "indexes": [
    {
      "collectionGroup": "scores",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "difficulty",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "score",
          "order": "DESCENDING"
        },
        {
          "fieldPath": "createdAt",
          "order": "ASCENDING"
        }
      ]
    },
    {
      "collectionGroup": "scores",
      "queryScope": "COLLECTION",
      "fields": [
        {
          "fieldPath": "difficulty",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "seconds",
          "order": "ASCENDING"
        },
        {
          "fieldPath": "createdAt",
          "order": "ASCENDING"
        }
      ]
    }
  ],
  "fieldOverrides": []
}
```

## 5ë‹¨ê³„: Firebase í”„ë¡œì íŠ¸ ì´ˆê¸°í™” (ì„ íƒ/í™•ì¸)
í”„ë¡œì íŠ¸ í´ë”ì—ì„œ í„°ë¯¸ë„ì„ ì—´ê³ , ì´ í´ë”ë¥¼ Firebase í”„ë¡œì íŠ¸ì™€ ì—°ê²°í•©ë‹ˆë‹¤.

```bash
firebase init firestore
```
1. `Are you ready to proceed?` ì§ˆë¬¸ì— `Y`ë¥¼ ìž…ë ¥í•©ë‹ˆë‹¤.
2. `Use an existing project`ë¥¼ ì„ íƒí•˜ê³ , **ì‚¬ì²œì„±(sacheonseong)** í”„ë¡œì íŠ¸ë¥¼ ê³ ë¦…ë‹ˆë‹¤.
3. `What file should be used for Firestore Rules?` ì§ˆë¬¸ì—ëŠ” ì—”í„°(ê¸°ë³¸ê°’)ë¥¼ ì¹©ë‹ˆë‹¤.
4. **`What file should be used for Firestore indexes?`** ì§ˆë¬¸ì—ëŠ” ë°©ê¸ˆ ìš°ë¦¬ê°€ ë§Œë“  íŒŒì¼ ì´ë¦„ì¸ **`firestore.indexes.json`**ì„ ìž…ë ¥í•©ë‹ˆë‹¤. (í˜¹ì€ ë®ì–´ì“¸ê±°ëƒê³  ë¬»ëŠ”ë‹¤ë©´ `N`ì„ ëˆ„ë¦…ë‹ˆë‹¤.)

## 6ë‹¨ê³„: ìƒ‰ì¸(ì¸ë±ìŠ¤) ì „ì²´ ë°°í¬ ì‹¤í–‰ ðŸš€
ì´ì œ ëª¨ë“  ì¤€ë¹„ê°€ ëë‚¬ìŠµë‹ˆë‹¤. í„°ë¯¸ë„ì— ì•„ëž˜ ëª…ë ¹ì–´ 1ì¤„ì„ ìž…ë ¥í•˜ë©´, ë‘ ê°€ì§€ ë³µí•© ìƒ‰ì¸ì´ Firebase ì„œë²„ì— ì¼ê´„ ìƒì„±ë©ë‹ˆë‹¤.

```bash
firebase deploy --only firestore:indexes
```

* `Deploy complete!` ë©”ì‹œì§€ê°€ ë‚˜ì˜¤ë©´ ì„±ê³µì ìœ¼ë¡œ ëª…ë ¹ì´ ì „ë‹¬ëœ ê²ƒìž…ë‹ˆë‹¤.
* Firebase í´ë¼ìš°ë“œ ì„œë²„ì—ì„œ ìƒ‰ì¸ì„ êµ¬ì¶•í•˜ëŠ”ë° **ë³´í†µ 1~2ë¶„ ì •ë„ì˜ ì‹œê°„ì´ ì†Œìš”**ë˜ë©°, êµ¬ì¶•ì´ ëë‚˜ë©´ ì•± ë‚´ ë¦¬ë”ë³´ë“œì— ì—ëŸ¬ ì—†ì´ ëž­í‚¹ì´ ì •ìƒ í‘œì‹œë©ë‹ˆë‹¤.

---
**ðŸ’¡ (ì°¸ê³ ) ê¸°ì¡´ ì›¹ ìƒ‰ì¸ ì„¤ì • ë°±ì—… íŒ:**
ë§Œì•½ Firebase ì›¹ ì½˜ì†” í™”ë©´ì—ì„œ ìƒ‰ì¸ì„ ë§Œë“¤ì—ˆê³ , ì´ë¥¼ ë‚´ ì»´í“¨í„°ì—ë„ ë‹¤ìš´ë¡œë“œí•´ ë°±ì—…í•˜ê³  ì‹¶ë‹¤ë©´ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.
```bash
firebase firestore:indexes > firestore.indexes.json
```
